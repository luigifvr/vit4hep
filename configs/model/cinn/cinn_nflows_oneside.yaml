_target_: experiments.calochallenge.model.CaloChallengeCINN
in_channels: 1
shape: [45, 16, 9]
patch_shape: [3, 8, 1]

coupling_block: OneSidedCaloRQSplineNFlows
nblocks: 10
is_spatial: [False, True, False, True, False, True, False, True, False, True] # 4
spatial_factor: [1,2,1]
cinn_kwargs: 
  num_bins: 14
  bounds_init: 23 # (left, right, bottom, top)

vit_kwargs:
  dim: 3
  x1_channels: 23
  condition_dim: 46
<<<<<<< Updated upstream:configs/model/cinn_nflows.yaml
  out_channels: 2
  final_layer_channels: 23
  hidden_dim: 360
  depth: 2
  num_heads: 6
=======
  hidden_dim: 192
  out_channels: 1
  depth: 3
  num_heads: 4
>>>>>>> Stashed changes:configs/model/cinn/cinn_nflows.yaml
  mlp_ratio: 4.0
  attn_drop: 0
  proj_drop: 0
  pos_embedding_coords: 'cartesian'
  learn_pos_embed: True
  causal_attn: False
  cos_attn: False
  final_conv: False
  checkpoint_grads: False
  use_torch_sdpa: False  # use xformers instead
